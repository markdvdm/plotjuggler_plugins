---
# common struct (types) schema definitions
#
# These structs are basic C-structs w/ inheritance
# *NOTE:* To preserve the original use of simple structs
#         used in the busRegistry, the message member
#         data is generated as simple structs
#         (i.e. structs are generated by bus_object_schema
#         and this file). If they are defined in both files
#         they must MATCH.
#
#
#
# Information on the set of available fields are as follows:
#
# - struct:                 (Required - key in struct dictionary)
#    name : NameOfStruct    (Required)
#    inherit :              (Optional - iheritance dictionary)
#      name : SomeName      (Required - name of parent struct)
#    members :              (Required - list of member dictionaries, but may be empty)
#      - name : MemberName  (Required - member name)
#        type : None        (Required - Supported types:
#                                       fix-width integers, float,
#                                       double, enums (per enumerates_schema),
#                                       or stuct (per this file).
#                                       Arrays support, i.ee: `type : uint8_t[10]` )
#        default : None      (Optional - default initalized value)
#
#    # metadata is calculated and added by elroy_common_msg_generator.py.
#    # it is included here for the curious typer
#    metadata :
#      members :            (data member info)
#        - name : None      (name)
#          array_len : X    (int(X) > 0)
#          type : None      (type)
#          default : None   (initialization)
#          is_struct : None (True/False if this data member is a struct)
#      file :
#        name : None        (name of file, no extension)
#        path : None        (file's path, name included)
#        header :           (header info, no source file)
#          extension: ".h"
#          include_guard:   (header file include guard)
#          includes :       (list of header include files: parent classes, enums, etc)
#            - None
#            - None

# The following structs are used for automated testing. Please do not modify these structs. If necessary, prefer to
# add more test structs rather than modify existing ones.

###

# Do not delete!
# Structs without inheritance will default to this to ensure a common base class.
- struct:
    name: BusObjectStruct
    members: [] # No data is actually needed for the base class, so this is empty
###

- struct:
    name: TestStructDefaultEnums
    members:
      - name: enum1
        type: TestEnum
        default: TestEnum::FirstEnumValue
- struct:
    name: TestStructSingleValue
    members:
      - name: some_val
        type: uint32_t
        default: 9
- struct:
    name: TestStructArray
    members:
      - name: some_array
        type: uint16_t[5]
- struct:
    name: TestStructInheritanceA
    members:
      - name: apples
        type: uint16_t
        default: 40
      - name: pears
        type: float[3]
- struct:
    name: TestStructInheritanceB
    inherit:
      name: TestStructInheritanceA
    members:
      - name: struct_array
        type: TestStructSingleValue[3]
- struct:
    name: TestStructInheritanceC
    inherit:
      name: TestStructInheritanceB
    members:
      - name: float_value
        type: float
        default: 9.9
- struct:
    name: TestEmptyStruct
    members: []
- struct:
    name: TestEmptyInheritance
    inherit:
      name: TestEmptyStruct
    members: []
- struct:
    name: TestPartialEmptyInheritance
    inherit:
      name: TestEmptyStruct
    members:
      - name: test_value
        type: uint32_t
        default: 1

# END test structs

- struct:
    name: SystemComponentInstance
    # helpful data struct to succinctly identify a system component
    members:
      - name: component
        type: SystemComponentId
      - name: instance
        type: InstanceId
      - name: location
        type: AirframeLocation
- struct:
    name: HealthReport
    # Aggregate for overall health level with specific results for each health check performed on a system component.
    members:
      - name: health_level
        type: HealthLevel
      - name: results
        type: HealthLevel[20]
- struct:
    name: ThrusterCommands
    # command indexes are 0-based IDs for thrusters
    members:
      - name: vl_cmds
        type: float[8]
      - name: fp_cmds
        type: float[4]
- struct:
    name: CsServoCommands
    # command index is 0-based IDs for Cs [1-11]
    members:
      - name: cmds
        type: float[11]
- struct:
    name: TimeInHms
    members:
      - name: hours
        type: uint8_t
      - name: minutes
        type: uint8_t
      - name: seconds
        type: uint8_t
- struct:
    name: PidGains
    members:
      - name: k_p
        type: float
      - name: k_i
        type: float
      - name: k_d
        type: float
- struct:
    name: CommunicationStatisticsReport
    members:
      - name: frequency_hz
        type: double
      - name: throughput_bits_per_second
        type: double
      - name: msg_to_process_rate
        type: double
      - name: percentage_of_expected_frequency
        type: double

- struct:
    name: VersionInfo
    members:
      - name: major
        type: uint8_t
      - name: minor
        type: uint8_t
      - name: patch
        type: uint8_t
      - name: build
        type: uint8_t
      # Note: commit_hash is intended to be the binary hash, not ASCII hex, which
      # is either SHA-1 or SHA256 depending on git version (hence the len field)
      - name: commit_hash
        type: uint8_t[32]
      - name: commit_hash_len
        type: uint8_t
      - name: dirty_status
        type: bool

# ----------------------------------- #
# electronic circuit breaker unit
# ----------------------------------- #
- struct:
    name: EcbState
    members:
      - name: is_faulted
        type: bool
      - name: ecb_state_info
        type: EcbStateInfo
# ----------------------------------- #
# integration_sim struct definitions
# ----------------------------------- #
- struct:
    name: Vector3d
    members:
      - name: x
        type: double
      - name: y
        type: double
      - name: z
        type: double
- struct:
    name: Quaternion
    members:
      - name: x
        type: double
      - name: y
        type: double
      - name: z
        type: double
      - name: w
        type: double
# ----------------------------------- #
# GNC
# ----------------------------------- #
# The GNC schema is auto-generated by a MATLAB script. THe script resolves stylistic changes on the member naming scheme.
# The script however does not modify the name of the data structure at all, specififcally we do not remove the 'BusObj'
# signifier at the end of struct name. This helps resolve the difference between message types that have been duplicated.
# The goal is to eventually remove duplicate struct data types and then fix the naming. This is blocked by the fact that
# some of the duplicated data structures actually have slightly different structures e.g.  ThrusterCmdsBusObj vs ThrusterCmds
- struct:
    name: AccelerationCmdsBusObj
    members:
      - name: udot_cmd_mps_2
        type: float
      - name: wdot_cmd_mps_2
        type: float
      - name: pdot_cmd_rps_2
        type: float
      - name: qdot_cmd_rps_2
        type: float
      - name: rdot_cmd_rps_2
        type: float

- struct:
    name: ActuatorCmdsBusObj
    members:
      - name: thruster_cmds_a
        type: ThrusterCmdsBusObj
      - name: servo_cmds_deg
        type: ServoCmdsBusObj

- struct:
    name: ActuatorForceMomentCmdsBusObj
    members:
      - name: surf_cmds_nm
        type: float[3]
      - name: thruster_cmds_n
        type: float[12]

- struct:
    name: ActuatorInversePowerApproximationBusObj
    members:
      - name: scale_factor
        type: float
      - name: usable_power_w
        type: float
      - name: total_request_power_w
        type: float
      - name: total_command_power_w
        type: float
      - name: spare_command_power_w
        type: float
      - name: spare_power_w
        type: float
      - name: request_power_w
        type: float[12]
      - name: command_power_w
        type: float[12]

- struct:
    name: AirDataBusObj
    members:
      - name: airspeed_mps
        type: float
      - name: indicated_airspeed_mps
        type: float
      - name: angle_of_attack_deg
        type: float
      - name: angle_of_sideslip_deg
        type: float
      - name: pressure_alt_m
        type: float
      - name: static_press_pa
        type: float
      - name: total_press_pa
        type: float
      - name: qbar_pa
        type: float
      - name: external_temp_c
        type: float
      - name: health_report
        type: SystemHealthReportBusObj

- struct:
    name: EtcInputBusObj
    members:
      - name: test_number
        type: uint8_t
      - name: etc_objective_state
        type: EtcObjectiveStateEnum
      - name: etc_channel
        type: EtcChannelEnum
      - name: etc_signal
        type: float
      - name: etc_time_s
        type: float

- struct:
    name: EtcLoggingBusObj
    members:
      - name: etc_output
        type: EtcOutputBusObj

- struct:
    name: EtcOutputBusObj
    members:
      - name: etc_input
        type: EtcInputBusObj
      - name: ref_cmd
        type: float
      - name: loop_fdbk
        type: float
      - name: loop_error
        type: float
      - name: loop_output
        type: float
      - name: loop_break_output
        type: float

- struct:
    name: ExternalCommandsBusObj
    members:
      - name: mission_start_request
        type: bool
      - name: etc_ID_request
        type: uint8_t
      - name: mode_request
        type: ModeTransitionRequestBusObj
      - name: rc_armed_state
        type: ArmedStateEnum
      - name: pilot_control_request
        type: bool
      - name: pilot_commands
        type: PilotCommandsBusObj
      - name: rc_health
        type: SystemHealthEnum

- struct:
    name: FswModeControllersBusObj
    members:
      - name: vmm_mode
        type: ModeEnum
      - name: actuator_mode
        type: ModeEnum

- struct:
    name: GroundDetectorBusObj
    members:
      - name: state
        type: GroundDetectorEnum
      - name: health
        type: VotingModeEnum

- struct:
    name: ImuDataBusObj
    members:
      - name: roll_rate_rps
        type: float
      - name: pitch_rate_rps
        type: float
      - name: yaw_rate_rps
        type: float
      - name: roll_angle_rad
        type: float
      - name: pitch_angle_rad
        type: float
      - name: yaw_angle_rad
        type: float
      - name: x_accel_g
        type: float
      - name: y_accel_g
        type: float
      - name: z_accel_g
        type: float

- struct:
    name: InnerLoopCmdsBusObj
    members:
      - name: roll_axis_command
        type: float
      - name: pitch_axis_command
        type: float
      - name: yaw_axis_command
        type: float
      - name: vertical_axis_command
        type: float
      - name: longitudinal_axis_command
        type: float

- struct:
    name: InsBusObj
    members:
      - name: health_report
        type: SystemHealthReportBusObj
      - name: ypr_rad
        type: float[3]
      - name: pos_lla
        type: double[3]
      - name: pqr_rps
        type: float[3]
      - name: vel_ned_mps
        type: float[3]
      - name: accel_mps_2
        type: float[3]

- struct:
    name: MissionItemBusObj
    members:
      - name: mission_item_ID
        type: uint8_t
      - name: mission_item_type
        type: FlightModeEnum
      - name: lat_deg
        type: double
      - name: lon_deg
        type: double
      - name: alt_m
        type: double
      - name: parameter_1
        type: double
      - name: parameter_2
        type: double
      - name: parameter_3
        type: double
      - name: parameter_4
        type: double

- struct:
    name: MixerPowerApproximationBusObj
    members:
      - name: wdot_to_torque_nmpmps_2
        type: float
      - name: udot_to_torque_nmpmps_2
        type: float
      - name: usable_power_w
        type: float
      - name: request_udot_power_w
        type: float
      - name: request_wdot_power_w
        type: float
      - name: request_power_w
        type: float
      - name: available_udot_power_w
        type: float
      - name: available_wdot_power_w
        type: float
      - name: command_udot_power_w
        type: float
      - name: command_wdot_power_w
        type: float
      - name: command_power_w
        type: float

- struct:
    name: ModeControlOutputBusObj
    members:
      - name: phase_of_flight
        type: PhaseOfFlightEnum
      - name: fc_mode_controller_state
        type: ModeControllerStateBusObj

- struct:
    name: ModeControllerStateBusObj
    members:
      - name: mode_controller_type
        type: ModeControllerEnum
      - name: current_mode
        type: ModeEnum
      - name: last_requested_mode
        type: ModeEnum
      - name: last_mode_request_result
        type: ModeTransitionRequestResult

- struct:
    name: ModeTransitionRequestBusObj
    members:
      - name: mode_controller_type
        type: ModeControllerEnum
      - name: requested_mode
        type: ModeEnum

- struct:
    name: NavDataBusObj
    members:
      - name: lat_fb_deg
        type: double
      - name: lon_fb_deg
        type: double
      - name: alt_fb_m
        type: double
      - name: vel_n_mps
        type: float
      - name: vel_e_mps
        type: float
      - name: vel_d_mps
        type: float
      - name: vel_u_mps
        type: float
      - name: vel_v_mps
        type: float
      - name: vel_w_mps
        type: float
      - name: groundspeed_mps
        type: float
      - name: ground_detector
        type: GroundDetectorBusObj

- struct:
    name: OuterLoopCmdsBusObj
    members:
      - name: position_cmds
        type: PositionCmdsBusObj
      - name: vel_fld_cmds
        type: VelFldCmdsBusObj
      - name: yaw_rad
        type: float
      - name: disable_horizontal_pos_control
        type: bool
      - name: disable_vertical_pos_control
        type: bool
      - name: tgp_arams
        type: TGParamsBusObj

- struct:
    name: PilotCommandsBusObj
    members:
      - name: longitudinal_axis_command
        type: float
      - name: vertical_axis_command
        type: float
      - name: roll_axis_command
        type: float
      - name: pitch_axis_command
        type: float
      - name: yaw_axis_command
        type: float

- struct:
    name: PositionCmdsBusObj
    members:
      - name: n_cmd_m
        type: double
      - name: e_cmd_m
        type: double
      - name: lat_deg
        type: double
      - name: lon_deg
        type: double
      - name: alt_m
        type: double
      - name: lat_ref_deg
        type: double
      - name: lon_ref_deg
        type: double

- struct:
    name: ServoCmdsBusObj
    members:
      - name: servo_1_cmd_deg
        type: float
      - name: servo_2_cmd_deg
        type: float
      - name: servo_3_cmd_deg
        type: float
      - name: servo_4_cmd_deg
        type: float
      - name: servo_5_cmd_deg
        type: float
      - name: servo_6_cmd_deg
        type: float
      - name: servo_7_cmd_deg
        type: float
      - name: servo_8_cmd_deg
        type: float
      - name: servo_9_cmd_deg
        type: float
      - name: servo_10_cmd_deg
        type: float
      - name: servo_11_cmd_deg
        type: float

- struct:
    name: SystemHealthReportBusObj
    members:
      - name: health_level
        type: SystemHealthEnum
      - name: results
        type: SystemHealthEnum[20]

- struct:
    name: TGParamsBusObj
    members:
      - name: alt_tg
        type: TGStructureSingleBusObj
      - name: yaw_tg
        type: TGStructureSingleBusObj
      - name: pos_tg
        type: TGStructureSingleBusObj
      - name: fld_vel_tg
        type: TGStructureTripleBusObj

- struct:
    name: TGStructureSingleBusObj
    members:
      - name: max_vel
        type: float
      - name: max_accel
        type: float
      - name: reset_tg
        type: bool

- struct:
    name: TGStructureTripleBusObj
    members:
      - name: reset_tg
        type: bool
      - name: max_vel
        type: float[3]
      - name: max_accel
        type: float[3]

- struct:
    name: ThrusterCmdsBusObj
    members:
      - name: m_1_cmd_a
        type: float
      - name: m_2_cmd_a
        type: float
      - name: m_3_cmd_a
        type: float
      - name: m_4_cmd_a
        type: float
      - name: m_5_cmd_a
        type: float
      - name: m_6_cmd_a
        type: float
      - name: m_7_cmd_a
        type: float
      - name: m_8_cmd_a
        type: float
      - name: t_1_cmd_a
        type: float
      - name: t_2_cmd_a
        type: float
      - name: t_3_cmd_a
        type: float
      - name: t_4_cmd_a
        type: float

- struct:
    name: VelFldCmdsBusObj
    members:
      - name: vel_forward_cmd_mps
        type: float
      - name: vel_lateral_cmd_mps
        type: float
      - name: h_dot_cmd_mps
        type: float

- struct:
    name: BmsVersionInfo
    members:
      - name: major
        type: uint8_t
      - name: minor
        type: uint8_t
      - name: patch
        type: uint8_t
      - name: build
        type: uint8_t
      - name: hw_version_major
        type: uint8_t
      - name: hw_version_minor
        type: uint8_t
